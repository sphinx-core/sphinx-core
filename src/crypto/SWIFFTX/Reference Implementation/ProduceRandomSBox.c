// Produce random S-Box for SWIFFTX.
// Do it similarly to producing IV - take the e decimal expansion as a source of randomness.
// The difference here is that we make sure this is a permutation.

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "SHA3.h"
#include "SWIFFTX.h"

void CreateSBox()
{
	// Starts where we finished in the calculation of IVs.
	// We need 256 * 3 = 768 decimal digits.
	// It turns out we needed 6750! 
	// Here we put 100 on each line.

	const char eDecimalExpansion[] = 
{"6377211125238978442505695369677078544996996794686445490598793163688923009879312773617821542499922957\
6351482208269895193668033182528869398496465105820939239829488793320362509443117301238197068416140397\
0198376793206832823764648042953118023287825098194558153017567173613320698112509961818815930416903515\
9888851934580727386673858942287922849989208680582574927961048419844436346324496848756023362482704197\
8623209002160990235304369941849146314093431738143640546253152096183690888707016768396424378140592714\
5635490613031072085103837505101157477041718986106873969655212671546889570350354021234078498193343210\
6817012100562788023519303322474501585390473041995777709350366041699732972508868769664035557071622684\
4716256079882651787134195124665201030592123667719432527867539855894489697096409754591856956380236370\
1621120477427228364896134225164450781824423529486363721417402388934412479635743702637552944483379980\
1612549227850925778256209262264832627793338656648162772516401910590049164499828931505660472580277863\
1864155195653244258698294695930801915298721172556347546396447910145904090586298496791287406870504895\
8586717479854667757573205681288459205413340539220001137863009455606881667400169842055804033637953764\
5203040243225661352783695117788386387443966253224985065499588623428189970773327617178392803494650143\
4558897071942586398772754710962953741521115136835062752602326484728703920764310059584116612054529703\
0236472549296669381151373227536450988890313602057248176585118063036442812314965507047510254465011727\
2115551948668508003685322818315219600373562527944951582841882947876108526398139559900673764829224437\
5287184624578036192981971399147564488262603903381441823262515097482798777996437308997038886778227138\
3605772978824125611907176639465070633045279546618550966661856647097113444740160704626215680717481877\
8443714369882185596709591025968620023537185887485696522000503117343920732113908032936344797273559552\
7734907178379342163701205005451326383544000186323991490705479778056697853358048966906295119432473099\
5876552368128590413832411607226029983305353708761389396391779574540161372236187893652605381558415871\
8692553860616477983402543512843961294603529133259427949043372990857315802909586313826832914771163963\
3709240031689458636060645845925126994655724839186564209752685082307544254599376917041977780085362730\
9417101634349076964237222943523661255725088147792231519747780605696725380171807763603462459278778465\
8506560507808442115296975218908740196609066518035165017925046195013665854366327125496399085491442000\
1457476081930221206602433009641270489439039717719518069908699860663658323227870937650226014929101151\
7177635944602023249300280401867723910288097866605651183260043688508817157238669842242201024950551881\
6948032210025154264946398128736776589276881635983124778865201411741109136011649950766290779436460058\
5194199856016264790761532103872755712699251827568798930276176114616254935649590379804583818232336861\
2016243736569846703785853305275833337939907521660692380533698879565137285593883499894707416181550125\
3970646481719467083481972144888987906765037959036696724949925452790337296361626589760394985767413973\
5944102374432970935547798262961459144293645142861715858733974679189757121195618738578364475844842355\
5581050025611492391518893099463428413936080383091662818811503715284967059741625628236092168075150177\
7253874025642534708790891372917228286115159156837252416307722544063378759310598267609442032619242853\
1701878177296023541306067213604600038966109364709514141718577701418060644363681546444005331608778314\
3174440811949422975599314011888683314832802706553833004693290115744147563139997221703804617092894579\
0962716622607407187499753592127560844147378233032703301682371936480021732857349359475643341299430248\
5023573221459784328264142168487872167336701061509424345698440187331281010794512722373788612605816566\
8053714396127888732527373890392890506865324138062796025930387727697783792868409325365880733988457218\
7460210053114833513238500478271693762180049047955979592905916554705057775143081751126989851884087185\
6402603530558373783242292418562564425502267215598027401261797192804713960068916382866527700975276706\
9777036439260224372841840883251848770472638440379530166905465937461619323840363893131364327137688841\
0268112198912752230562567562547017250863497653672886059667527408686274079128565769963137897530346606\
1666980421826772456053066077389962421834085988207186468262321508028828635974683965435885668550377313\
1296587975810501214916207656769950659715344763470320853215603674828608378656803073062657633469774295\
6346437167093971930608769634953288468336130388294310408002968738691170666661468000151211434422560238\
7447432525076938707777519329994213727721125884360871583483562696166198057252661220679754062106208064\
9882918454395301529982092503005498257043390553570168653120526495614857249257386206917403695213533732\
5316663454665885972866594511364413703313936721185695539521084584072443238355860631068069649248512326\
3269951460359603729725319836842336390463213671011619282171115028280160448805880238203198149309636959\
6735832742024988245684941273860566491352526706046234450549227581151709314921879592718001940968866986\
8370373022004753143381810927080300172059355305207007060722339994639905713115870996357773590271962850\
6114651483752620956534671329002599439766311454590268589897911583709341937044115512192011716488056694\
5938131183843765620627846310490346293950029458341164824114969758326011800731699437393506966295712410\
2732391387417549230718624545432220395527352952402459038057445028922468862853365422138157221311632881\
1205214648980518009202471939171055539011394331668151582884368760696110250517100739276238555338627255\
3538830960671644662370922646809671254061869502143176211668140097595281493907222601112681153108387317\
6173232352636058381731510345957365382235349929358228368510078108846343499835184044517042701893819942\
4341009057537625776757111809008816418331920196262341628816652137471732547772778348877436651882875215\
6685719506371936565390389449366421764003121527870222366463635755503565576948886549500270853923617105\
5021311474137441061344455441921013361729962856948991933691847294785807291560885103967819594298331864\
2815886845707290544057510601285258056594703046836344592652552137008068752009593453607316226118728173\
9280746230946853678231060979215993600199462379934342106878134973469592464697525062469586169091785739\
7659519939299399556754271465491045686070209901260681870498417807917392407194599632306025470790177452\
7513186809982284730860766536866855516467702911336827563107223346726113705490795365834538637196235856\
3126183871567741187385277229225947433737856955384562468010139057278710165129666367644518724656537304\
0244368414081448873295784734849000301947788802046032466084287535184836495919508288832320652212810419\
0448047247949291342284951970022601310430062410717971502793433263407995960531446053230488528972917659\
8760166678119379323724538572096075822771784833616135826128962261181294559274627671377944875867536575\
4486140761193112595851265575973457301533364263076798544338576171533346232527057200530398828949903425\
9566232975782488735029259166825894456894655992658454762694528780516501720674785417887982276806536650\
6419109734345288783386217261562695826544782056729877564263253215942944180399432170000905426507630955\
8846589517170914760743713689331946909098190450129030709956622662030318264936573369841955577696378762\
4918852865686607600566025605445711337286840205574416030837052312242587223438854123179481388550075689\
3811249353863186352870837998456926199817945233640874295911807474534195514203517261842008455091708456\
8236820089773945584267921427347756087964427920270831215015640634134161716644806981548376449157390012"};

	unsigned char SBox[256] = {0};
	int SBoxIndex[256] = {0};
	int i, j;
	int currIndex = 0;

	for (i = 0; i < 256; )
	{
		char ch0[2] = {0};
		char ch1[2] = {0};
		char ch2[2] = {0};
		int currNumber = 0;

		if (i == 255)
		{
			for (j = 0; j < 256; ++j)
			{
				if (SBoxIndex[j] == 0)
				{
					SBox[i++] = j;
					break;
				}
			}

			break;
		}

		ch0[0] = eDecimalExpansion[currIndex];
		ch1[0] = eDecimalExpansion[currIndex + 1];
		ch2[0] = eDecimalExpansion[currIndex + 2];

		currNumber = (atoi(ch0) * 100)
				   + (atoi(ch1) * 10)
				   + (atoi(ch2));

		if (currNumber < (256 * 3))
		{
			currNumber %= 256;

			if (SBoxIndex[currNumber] == 0)
			{
				SBoxIndex[currNumber] = 1;
				SBox[i++] = currNumber;
			}
		}

		currIndex += 3;
	}

	for (i = 0; i < 256; ++i)
		printf("%4d,", SBox[i]);

	printf("\n\nIn HEXA:\n\n");

	for (i = 0; i < 256; ++i)
		printf("0x%02x, ", SBox[i]);

}

int main33()
{
	return 0;
}
